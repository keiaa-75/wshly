<!-- Card Creator Form Fragment -->
<div th:fragment="card-form">
    <!-- Mobile: Bottom Drawer -->
    <div class="md:hidden fixed bottom-0 left-0 right-0 bg-white border-t-2 border-pink-200 transform transition-transform duration-300 ease-in-out z-50"
         th:classappend="${showForm} ? 'translate-y-0' : 'translate-y-full'">
        
        <!-- Drawer Handle -->
        <div class="flex justify-center py-2 bg-pink-100 cursor-pointer" onclick="toggleForm()">
            <div class="w-12 h-1 bg-pink-400 rounded-full"></div>
        </div>
        
        <!-- Form Content -->
        <div class="p-4 max-h-96 overflow-y-auto">
            <h1 class="font-superhelio text-xl text-red-600 mb-4 text-center font-bold">CREATE CARD</h1>
            
            <form action="/card" method="get" class="space-y-3 max-w-sm mx-auto">
                <input type="hidden" name="f" value="0">
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc">FROM:</label>
                    <input type="text" name="senderName" placeholder="Your name" required
                           class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio text-sm">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc">TO:</label>
                    <input type="text" name="recipientName" placeholder="Recipient name" required
                           class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio text-sm">
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc">MESSAGE:</label>
                    <select name="mainMessage" 
                            class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio text-sm">
                        <option th:each="message : ${messages}" 
                                th:value="${message}" 
                                th:text="${message.displayText}">
                        </option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc">CUSTOM MESSAGE:</label>
                    <textarea name="customMessage" placeholder="Add your personal touch..." maxlength="150"
                              class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 h-16 resize-none font-superhelio text-sm"></textarea>
                </div>
                
                <button type="button" id="copyLink"
                        class="w-full bg-gradient-to-r from-pink-500 to-red-500 text-white font-bold py-3 rounded-lg hover:from-pink-600 hover:to-red-600 transition-colors font-superhelio">
                    COPY SHAREABLE LINK
                </button>
            </form>
        </div>
    </div>
    
    <!-- Mobile: Collapsed Handle (when drawer is hidden) -->
    <div th:if="${!showForm}" class="md:hidden fixed bottom-0 left-1/2 transform -translate-x-1/2 bg-pink-200 rounded-t-lg px-4 py-1 cursor-pointer shadow-lg z-50" onclick="toggleForm()">
        <div class="w-8 h-1 bg-pink-400 rounded-full mx-auto"></div>
        <div class="text-xs font-aux-dotbitc text-gray-600 mt-1">FORM</div>
    </div>
    
    <!-- Desktop: Side Pane -->
    <div class="hidden md:block w-80 bg-white border-r-2 border-pink-200 p-4 h-screen overflow-y-auto">
        <h1 class="font-superhelio text-2xl text-red-600 mb-6 font-bold">CREATE CARD</h1>
        
        <form action="/card" method="get" class="space-y-4">
            <input type="hidden" name="f" value="0">
            
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc text-base">FROM:</label>
                <input type="text" name="senderName" placeholder="Your name" required
                       class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio">
            </div>
            
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc text-base">TO:</label>
                <input type="text" name="recipientName" placeholder="Recipient name" required
                       class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio">
            </div>
            
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc text-base">MESSAGE:</label>
                <select name="mainMessage" 
                        class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 font-superhelio">
                    <option th:each="message : ${messages}" 
                            th:value="${message}" 
                            th:text="${message.displayText}">
                    </option>
                </select>
            </div>
            
            <div>
                <label class="block text-sm font-bold text-gray-700 mb-1 font-aux-dotbitc text-base">CUSTOM MESSAGE:</label>
                <textarea name="customMessage" placeholder="Add your personal touch..." maxlength="150"
                          class="w-full px-3 py-2 border border-pink-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-400 h-20 resize-none font-superhelio"></textarea>
            </div>
            
            <button type="button" id="copyLink"
                    class="w-full bg-gradient-to-r from-pink-500 to-red-500 text-white font-bold py-3 rounded-lg hover:from-pink-600 hover:to-red-600 transition-colors font-superhelio">
                COPY SHAREABLE LINK
            </button>
        </form>
    </div>
</div>

<script th:fragment="form-scripts">
    function toggleForm() {
        const url = new URL(window.location);
        const currentF = url.searchParams.get('f') || '0';
        const newF = currentF === '1' ? '0' : '1';
        url.searchParams.set('f', newF);
        window.location.href = url.toString();
    }
</script>
