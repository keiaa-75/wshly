<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head}"></head>
<body class="bg-gradient-to-br from-pink-50 to-red-50 min-h-screen font-aux-dotbitc">
    
    <!-- Card Display (when card exists) -->
    <div th:if="${card != null}" class="flex items-center justify-center min-h-screen p-4">
        <!-- Holiday Card -->
        <div class="bg-white rounded-lg shadow-xl border-4 border-cherry-400 p-6 max-w-sm mx-auto relative overflow-hidden">
            <div class="absolute inset-2 border-2 border-pink-300 rounded pointer-events-none"></div>
            
            <!-- Card Content -->
            <div class="relative z-10 text-center space-y-4">
                <!-- Main Message -->
                <h1 class="font-superhelio text-lg text-cherry-600 leading-relaxed pixel-shadow font-bold" 
                    th:text="${card.mainMessage.displayText}">Merry Christmas!</h1>
                
                <!-- To Line -->
                <div class="space-y-1">
                    <p class="font-aux-dotbitc text-gray-600 text-lg">TO:</p>
                    <p class="font-superhelio text-xl text-pink-600 font-bold" 
                       th:text="${card.recipientName}">Someone Special</p>
                </div>
                
                <!-- Custom Message -->
                <div th:if="${card.customMessage != null and !card.customMessage.isEmpty()}" 
                     class="bg-pink-50 border-2 border-pink-200 rounded p-3 mx-2">
                    <p class="font-aux-dotbitc text-gray-700 text-base leading-relaxed" 
                       th:text="${card.customMessage}">Custom message here</p>
                </div>
                
                <!-- From Line -->
                <div class="space-y-1 pt-2">
                    <p class="font-aux-dotbitc text-gray-600 text-lg">FROM:</p>
                    <p class="font-superhelio text-xl text-cherry-600 font-bold" 
                       th:text="${card.senderName}">Your Name</p>
                </div>
            </div>
            
            <!-- Pixel decorative corners -->
            <div class="absolute top-1 left-1 w-3 h-3 bg-cherry-300"></div>
            <div class="absolute top-1 right-1 w-3 h-3 bg-pink-300"></div>
            <div class="absolute bottom-1 left-1 w-3 h-3 bg-pink-300"></div>
            <div class="absolute bottom-1 right-1 w-3 h-3 bg-cherry-300"></div>
        </div>
        
        <!-- Floating Action Buttons -->
        <div class="fixed bottom-6 left-6 space-y-3">
            <button onclick="copyCardLink()" 
                    class="block bg-gradient-to-r from-cherry-500 to-cherry-600 text-white font-superhelio font-bold px-4 py-3 rounded-lg hover:from-cherry-600 hover:to-cherry-700 transition-colors shadow-lg">
                COPY
            </button>
            
            <a th:href="@{/?f=1}" 
               class="block bg-gradient-to-r from-pink-500 to-red-500 text-white font-superhelio font-bold px-4 py-3 rounded-lg hover:from-pink-600 hover:to-red-600 transition-colors shadow-lg text-center">
                NEW
            </a>
        </div>
    </div>
    
    <!-- Preview Layout (when no card) -->
    <div th:if="${card == null}" class="flex">
        <!-- Desktop: Form Pane -->
        <div th:replace="~{fragments/form :: card-form}"></div>
        
        <!-- Preview Area -->
        <div class="flex-1 flex items-center justify-center min-h-screen p-4 pb-20 md:pb-4">
            <div class="max-w-sm mx-auto">
                <h2 class="font-superhelio text-2xl text-center text-red-600 mb-4 font-bold">PREVIEW</h2>
                <!-- Preview Card (updated by jQuery) -->
                <div class="bg-white rounded-lg shadow-xl border-4 border-cherry-400 p-6 relative overflow-hidden">
                    <div class="absolute inset-2 border-2 border-pink-300 rounded pointer-events-none"></div>
                    <div id="card-preview" class="relative z-10 text-center space-y-4">
                        <h3 class="font-superhelio text-lg text-cherry-600 leading-relaxed pixel-shadow font-bold">Merry Christmas!</h3>
                        <div class="space-y-1">
                            <p class="font-aux-dotbitc text-gray-600 text-lg">TO:</p>
                            <p class="font-superhelio text-xl text-pink-600 font-bold">Someone Special</p>
                        </div>
                        <div class="space-y-1 pt-2">
                            <p class="font-aux-dotbitc text-gray-600 text-lg">FROM:</p>
                            <p class="font-superhelio text-xl text-cherry-600 font-bold">You</p>
                        </div>
                    </div>
                    <!-- Pixel decorative corners -->
                    <div class="absolute top-1 left-1 w-3 h-3 bg-cherry-300"></div>
                    <div class="absolute top-1 right-1 w-3 h-3 bg-pink-300"></div>
                    <div class="absolute bottom-1 left-1 w-3 h-3 bg-pink-300"></div>
                    <div class="absolute bottom-1 right-1 w-3 h-3 bg-cherry-300"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bottom Drawer Form -->
    <!-- (Form is now included in preview layout above) -->
    
    <!-- Scripts -->
    <script th:if="${card == null}" src="/js/card-creator.js"></script>
    <script th:replace="~{fragments/form :: form-scripts}"></script>
    
    <script th:if="${card != null}">
        function copyCardLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = 'COPIED!';
                btn.className = btn.className.replace('from-cherry-500 to-cherry-600', 'from-green-500 to-green-600');
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.className = btn.className.replace('from-green-500 to-green-600', 'from-cherry-500 to-cherry-600');
                }, 2000);
            });
        }
    </script>
    
    <style>
        .pixel-shadow {
            text-shadow: 2px 2px 0px rgba(220, 38, 38, 0.3);
        }
    </style>
</body>
</html>
